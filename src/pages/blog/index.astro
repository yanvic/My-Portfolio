---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/Layout.astro";
import "../../styles/blog.css";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);

function formatDate(date: Date) {
  return date.toLocaleDateString("pt-BR", {
    day: "2-digit",
    month: "short",
    year: "numeric",
  });
}
---

<BaseLayout lang="pt">
  <div class="blog-page">
    <a href="/pt" class="blog-back">&larr; Voltar</a>

    <h1 class="blog-page-title">Blog</h1>
    <p class="blog-page-subtitle">Artigos sobre desenvolvimento, arquitetura e tecnologia.</p>

    <div class="blog-list">
      {posts.map((post) => (
        <a href={`/blog/${post.id.replace(/\.md$/, "")}`} class="blog-post-card">
          <div class="blog-post-meta">
            <span class="blog-post-tag">{post.data.tag}</span>
            <span class="blog-post-date">{formatDate(post.data.date)}</span>
            <span class="blog-post-read-time">{post.data.readTime}</span>
          </div>
          <h2 class="blog-post-title">{post.data.title}</h2>
          <p class="blog-post-desc">{post.data.description}</p>
          <span class="blog-post-arrow">Ler artigo &rarr;</span>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
